<?xml version="1.0"?>

<!--
    THIS FILE SHOULD ENCRYPT SENSITIVE INFORMATION,
    PLEASE ENSURE BEFORE CHECKING INTO SOURCE CONTROL!

    This is a template for applying transforms when deploying to preview.ucosmic.com on Windows Azure.
    It is based on its sister file, Web.Release.config.

    When deploying to Azure, use the PKCS12ProtectedConfigurationProvider to encrypt sensitive sections:
    http://archive.msdn.microsoft.com/pkcs12protectedconfg
    http://blogs.msdn.com/b/sqlazure/archive/2010/09/07/10058942.aspx
    http://blogs.msdn.com/b/sqlazure/archive/2010/09/08/10059359.aspx
    http://blogs.msdn.com/b/sqlazure/archive/2010/09/09/10059889.aspx
    http://blogs.msdn.com/b/sqlazure/archive/2010/09/10/10060395.aspx

    For more information on using web.config transformation visit http://go.microsoft.com/fwlink/?LinkId=125889
-->

<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
    <configSections>
        <!-- Add AppFabric Caching Config Section when deploying to Azure -->
        <section name="dataCacheClients" type="Microsoft.ApplicationServer.Caching.DataCacheClientsSection, Microsoft.ApplicationServer.Caching.Core" allowLocation="true" allowDefinition="Everywhere" xdt:Transform="Replace" xdt:Locator="Match(name)" />
    </configSections>
    <configProtectedData xdt:Transform="Replace">
        <providers>
            <add name="CustomProvider" thumbprint="9975FCFAF342D1FB73631EB5A1CD9BCEF1F102F6"
                type="Pkcs12ProtectedConfigurationProvider.Pkcs12ProtectedConfigurationProvider, PKCS12ProtectedConfigurationProvider, Version=1.0.0.0, Culture=neutral, PublicKeyToken=34da007ac91f901d" />
        </providers>
    </configProtectedData>
    <dataCacheClients configProtectionProvider="CustomProvider" xdt:Transform="Replace">
        <EncryptedData Type="http://www.w3.org/2001/04/xmlenc#Element" xmlns="http://www.w3.org/2001/04/xmlenc#">
            <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc" />
            <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                <EncryptedKey xmlns="http://www.w3.org/2001/04/xmlenc#">
                    <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" />
                    <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                        <KeyName>rsaKey</KeyName>
                    </KeyInfo>
                    <CipherData>
                        <CipherValue>SUrdcwUm0e9Jo0aYzhliuBPFHQSTIiE4xgEg0oG0YlcBk0YmfHqKc6UXp8xgwwC/ucvV1NwstsxX/ynMKSlWSl302PFL67Fueh6vWncJ9s69ncW3LG9OhHGzlg5Ly+YPXty96dBhVgEtu/TzByjNHdAYPuJVJxRA087T8yMyg5E=</CipherValue>
                    </CipherData>
                </EncryptedKey>
            </KeyInfo>
            <CipherData>
                <CipherValue>1+7jX4JKXUk5JEdqb+ZygLgj+AFL0LrIAqX5pqLG50CB6ChKlupeGaLpIliok5GxNwJF/CqaLBPXc0HCxqfKwJt8IG7ijJ8o4NYcDZBrriw0GwogYiK3pdsY8pB9h6LLJWlPaivBTdRztIn4D+oEj103J8+/75v0sjxSmhuW+jqX9aLHeS9dIkKpzsvinJjFokj/XJUzIqsLapPlZhvmN5wponHZ/1z8CpULDCJN3XmofLYO8eE4eYqdO4fxOBQTxsGNIb6PHgcCibBCd2zmfIMtdgWd2GXcIioz4uCk9rMJ7NlxM4pVLdc7A6nr+kT5X/M4qOPK+tSCZAWAHoGo1prfWFO7/Xk3df+iVhqvYtFlq/ckkFFr/TfDFBJagPJxGVjCfktQnlDw3+0XlQ5/iX2x/3V/0t+aOxq19oMXLZLnCgkCF+DE8wRJhySVFkGFOeKLqezcB52rFWp0HVT2RTw1n1x0KdDCw1nzgfr1x+EiCQwPcYvwcH3zQVB1zh/ot79tcVXmFnMDV9mGxx6f9TabKF9PskT8+4dz3Cr9Z0VWxAQMUCJH4VpWelqUmZP9g0eluc9dVcKpmooRE18/1svcYn1+FsbqiWI55BXzizQXCtCMMH+cwW60yaKn+xwWnwbQ/DVpEltK30/Robn4NeEC3/y90Cb/v/RGkjaED1iuCTMTzcZ0ce3sYjNJsXPuuqjTjaf97ObH5P+/YoAab2T247n/mqgDCAd94KjaIrGWkcgqDt2Sq0CqRNSsbThGBc4EQEIysGWYvdMTOXWs8Zk6mbmGzjp9F4sczzhuO5fn2I9oRzLvsIa3zqN5W+xig+3UDbZkZ7n/ezT40anoUVEeSxdfYPRsvRbKdtxaM6wuEcxLRm/Ya5QfA4+hfbctcu2qaAwS04ECwpw3oF09nAkJOsYmxZNNK1Pp9btA80hh0zkIrDzrO6zC70tl8tEIEEDKSockLd5LSDZKX9lbYXi4Ojcv7OKrBJ2n2JtV5zOEHVqNiA2INiQjiv8SDYQiSgfy6qZh2hnHjt2GQeY7RjR4t6dgCqRsgHKSfZDTs57zHP1UUYiJ26SFlCqT3X7vxr5DDqphqhUpdEWbBBnes9yBlkYssBSvH/Z5evas+DnLDJ9e0NmQ2fqCS9CW+fCcAgVs5kVbTdkYOwDqyu6itcztQnf092ltDtjVr4qTAht1jAltRuAbA6eClASEabN38GGdGRJJ14vBw+a6OKp7ObJBHskaiEVOyNlgvqpXLwzIAoVBSm5R589HCVCTpC2vDWXJ2rv84h+Nj4B0w+TUfQ==</CipherValue>
            </CipherData>
        </EncryptedData>
    </dataCacheClients>
    <connectionStrings configProtectionProvider="CustomProvider" xdt:Transform="Replace">
        <EncryptedData Type="http://www.w3.org/2001/04/xmlenc#Element"
            xmlns="http://www.w3.org/2001/04/xmlenc#">
            <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc" />
            <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                <EncryptedKey xmlns="http://www.w3.org/2001/04/xmlenc#">
                    <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" />
                    <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                        <KeyName>rsaKey</KeyName>
                    </KeyInfo>
                    <CipherData>
                        <CipherValue>QVqndvdQ3n98/8FMLqcZyOciPO+yjaGC2qElUOmLXVGMpaVsUv9Oygup5QcOgcosq5tL4BNWuLYCAEsNQ25psGHxE7X9OWEbyMWLswCMmu4YMOBHw7UiPcVhwNz9NLo0JjqDKEWawZlvJU/84UcdpKAUAm5D/dd3ovcIfMQ0WDM=</CipherValue>
                    </CipherData>
                </EncryptedKey>
            </KeyInfo>
            <CipherData>
                <CipherValue>E7hGGPkBVqBdPKlxnZZwLM/JA4ARNEF9OPKHBt6/YVQpO2ikGO3GPiYZTnDUKPPnxnv8tjxOfs6tUGccNd6xvw3/A0QR/eiNA/iA1KZC7uEHc9r0xjW+bUOeOEggza6Gg7zvN96Kcu5zp6EXZ9Qb928bePHacEKFuMmNRhs4c6vpyt5uM4hobhJGKEhmFpXZGswrI4WY+uWE0N0j6D7wlTChof0kx65/Lb5hA+Z9oaMai5g3YnP99clrWbP9Z6n1ZESrFGzVYwkO3bPziJUzTMrnq04XUCJX4zaVKZQO0fcfncqwFpCEFz489nTlHg/9TH9/Ci6oVSDRkkCFc+79GnQ9W14HC5OGHtpucKdss9wu2Bnm/AC8RNMaa2snD4oVs0atfiO+oUOzp0/X9VKoGBDSJa1HMYsrWIsRI6zMnZalOI20HEkXZqGvNW2BOmNzseB4l0JEdMSfyDYRE8rbGAfLfLbgYshc0OJ9IbYfmOvAXU7Dk2a2zLut6daT9r/lMhL3XuSxPLRlGarzptss5ZtiU1xjLwhj8seTz/XCIdtf9w9wuSSmJ6uxFqXfJHBHK2B0/hwexMvRmvjh2QU/bGHkJFVf95zBleWKuDT34ZJ71b7niJKNwpBbcm9NUmwbV9sLox5JFdXLKEQX1I9raOWf7ZyWLKNueeHPSxqGsXxSC3Cw587mc4unRpmiR1aCemuXRQ5WO6ANEJNhOD+Sa4FEg9glYlFNmlq5N8egIdx96frlMi29OoIldR9msCrdIt8DvLGl4zE6IAd4cL3M3KbiQl1T+R47eBhcU+qim4TTX5vJQGO6qA+mq5q1YUE/4ksI69H/UeOh0L9JNzaPnA==</CipherValue>
            </CipherData>
        </EncryptedData>
    </connectionStrings>
    <appSettings configProtectionProvider="CustomProvider" xdt:Transform="Replace">
        <EncryptedData Type="http://www.w3.org/2001/04/xmlenc#Element" xmlns="http://www.w3.org/2001/04/xmlenc#">
            <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc" />
            <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                <EncryptedKey xmlns="http://www.w3.org/2001/04/xmlenc#">
                    <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" />
                    <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                        <KeyName>rsaKey</KeyName>
                    </KeyInfo>
                    <CipherData>
                        <CipherValue>sBfSRpV+/piHta079GXuQbu4mTGiVQYOi+Dt+LDJj2d8A7mhO0RQLEtYZVYpNOfX5tpO5FBiMG2ZSS3d2AYylYq9Z07rA4RnuClwxig3O/00pFb72R3FJcCk9C4cWirN6GVA4m4F0/+WHsUqH5Wpk8wf30pZViMtq5N8eNqIpyU=</CipherValue>
                    </CipherData>
                </EncryptedKey>
            </KeyInfo>
            <CipherData>
                <CipherValue>YPVZH+WvTV38LyN7BI/5uAcMhqq/4jCkK2nA72xHqsl1k5nb2YaLKq554qSGiwNR9v0JHJ7QYFANq9Z7ImLrFT4/aktBQdZBlftZDUUnh8VuJcZHaZl1JvOZaasLh+81muoxKM4+KuLskTTXJyiMJSHahHGWb/VvPO/niquZYhb9cd8WY9cbql0a2qsqLGG5l7TQQT4rXuBLY9lKNQ+jQPtGYYV2BL7+3gPMi1A6x/lXzHABaxccjMcLZbIwDcTn8H0sFKxhufS4iHu4Yb+FRxH+U+6ciHzkkwTWb1K2g7V8MJh82t81TsbTaNpV5wsXZCoT9O9JT6w963HQC1ly4LlqfOxxYA2ehFIYY1Giz19qaERHtxhSaKQV8RP1WEC6SxbLCRn+/en432w74bOAV0d6UboHpdmiY/XKXwowyl1aatxw/oO5VMD9nyE4pVNi7jV7j/sLbRm79Yzkjr97aQDJgafxssY/9zf4XNRGIp/o5gmVFakrbuGeaF+ZQ14mnfXQKe2PLdlv9VsqXxZMRw0JnPq7p3fGw/c17LXH8Fva7zjMdm3SLPs8O/c0Jy1BTrmbqlWUzbZbyfruApF5kQadqyjUBw3rAFEn+A645UZx98z6jG3ug5KSQ9SVF7ZkGyYPS6qEwlJ6nKz5CI1k06awZ+h+TyR3BhQd/dXAb0bRQBPU2JQ01y1iWT1URsBWBdA4y5vooWTavsi02zEePSo3PGPbWMXBvUlIBMaCbQweIkriNeLFcyh04ycR4YLRvE/9WGdmeCLNDk/EJ25qTCZSrW331Cgo5goVhc+baQ2lzykWA6Hc/kv+rR2NCldmO4HcxA4c9RTCOooVa1z1hMFUV1T/R5271p2xnlRJFNfcWY0A+GNNG1en0VC/WIumfiXCfKseiNqaRfd1Fvy8ZAXugDi5EVdIHA1GzxkN/N37xweaatAIS75/uzIg2fKpvM3RDoEROz5tJ1/PGPlxvj6sJn+MKqKXnWvqj9imxLeuiQ6H4CcRvT2lgyK6c59ALq7j7NhCHSsTiSoBlKkhnMiR3gMhDr0K4gK+WPxJfxafV16orptfKip7k9nwi7SpdJ5/XlsfRoccYK0PGo+m4YVjHA2QRLHkJbevz3DGjaSM73pYmd/WZmbSnVrR2WXf3nSuVDQTa/8nFUcDkyST3bG+o8IcOk+h/B2DcdH4dNcwjqkGFouPkh6OMbrApv0y4DJZbYnf1E6EJ8pUepttiSzy6s0EMNbYBg2jaISXEhWCwEOCOSVehlpgM3GfNaWHD0u4d/vJfw31KG/IlvD9DWyKx231To4xIeMPvrNmbqdoaxa/718wSOAidtdU5vj90YSXdvU8w7YHQF9sEVPMfa2hotgJB+GlZteSbPWlGFE5n/F3s0VlHACqUsQnlIyR//CpeStqFnzI19oBZqfP8QhMMVJAtJFtCWZ6kiAbzvjEjpj95lJ75HJPqSfKdeJoinBptGAFmEkJ5VEgN624y+V7nqYm6KIkImcMQc4f/0wq4vjQf1C7g1nQTvYGuzYGA0zt+G/D6oLnMe+FfltCnE9XQVu/gkILnVehrb/K/jKrwWRGNnl7nBGm5WwLLTnuqHxqQS367X9FaiOPJ0VDAPef+ESrVqSYYRSv+TPPxgscp7PQOKLRpbdhOnpqTmlbwYtR1F6jpZUKpq7vB5JXn3l3IFwAI6q3Z6xVrz2e0PVbRO/ev3N5ODMIAjWALmij</CipherValue>
            </CipherData>
        </EncryptedData>
    </appSettings>
    <system.web>
        <compilation xdt:Transform="RemoveAttributes(debug)" />
        <authentication mode="Forms">
            <forms timeout="2880" cookieless="UseCookies" ticketCompatibilityMode="Framework40" requireSSL="true" xdt:Transform="SetAttributes" />
        </authentication>
        <membership defaultProvider="AspNetSqlMembershipProvider" xdt:Transform="Replace">
            <providers>
                <clear />
                <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="true" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="preview.ucosmic.com" />
            </providers>
        </membership>
        <profile defaultProvider="AspNetSqlProfileProvider" xdt:Transform="Replace">
            <providers>
                <clear />
                <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="preview.ucosmic.com" />
            </providers>
        </profile>
        <customErrors mode="On" xdt:Transform="SetAttributes">
        </customErrors>
        <!-- Use AppFabric Caching for Session State -->
        <sessionState mode="Custom" customProvider="AppFabricCacheSessionStoreProvider" xdt:Transform="Replace">
            <providers>
                <add name="AppFabricCacheSessionStoreProvider" type="Microsoft.Web.DistributedCache.DistributedCacheSessionStateStoreProvider, Microsoft.Web.DistributedCache" cacheName="default" useBlobMode="true" dataCacheClientName="SslEndpoint" />
            </providers>
        </sessionState>
        <!-- Use AppFabric Output Cache -->
        <caching xdt:Transform="Replace">
            <outputCache defaultProvider="DistributedCache">
                <providers>
                    <add name="DistributedCache" type="Microsoft.Web.DistributedCache.DistributedCacheOutputCacheProvider, Microsoft.Web.DistributedCache" cacheName="default" dataCacheClientName="SslEndpoint" applicationName="preview.ucosmic.com" />
                </providers>
            </outputCache>
        </caching>
        <httpRuntime executionTimeout="1800" maxRequestLength="30720" xdt:Transform="Replace" />
    </system.web>
    <system.net>
        <mailSettings>
            <smtp configProtectionProvider="CustomProvider" xdt:Transform="Replace">
                <EncryptedData Type="http://www.w3.org/2001/04/xmlenc#Element"
                    xmlns="http://www.w3.org/2001/04/xmlenc#">
                    <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc" />
                    <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                        <EncryptedKey xmlns="http://www.w3.org/2001/04/xmlenc#">
                            <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" />
                            <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                                <KeyName>rsaKey</KeyName>
                            </KeyInfo>
                            <CipherData>
                                <CipherValue>PMA3PsJcpQbhstyex6pxH4aIIq1vfWojHF371A1Qf4rmmLA1eD5icRLrTwD6lr0pKtej3LqenCagyh5aMfGjVhKoi/MuFDV5TPt5wv6aqe8NUqnYHwtIFjQIPPdqVQWyb6/3DRxJQmTVlzFXfWsBpCvCaUZrr/XU5RrPYcria4I=</CipherValue>
                            </CipherData>
                        </EncryptedKey>
                    </KeyInfo>
                    <CipherData>
                        <CipherValue>18/gjhnTpBVgvfp04p45SXZ7Mxyg3tLcfnqqimkM5SgPfjD2ruzOCRJhISsN9+yPMtJZSP5M8UsvQ8dt39o+D6JohVoJ7rkq3c/zy2gU7n6yUHmchdSok0MdEcsyT1P6qNsRNHsoMJMsEwETRFmDfK4GUnPkhcfYfDT5UYpksQg2/+VPtTJkq/09ZokmHWnnQ+6nIWCuk6guEXrHlX47Xw==</CipherValue>
                    </CipherData>
                </EncryptedData>
            </smtp>
        </mailSettings>
    </system.net>
    <!-- Ensure Elmah is set up for the appropriate application and mail provider -->
    <elmah xdt:Transform="Replace">
        <security allowRemoteAccess="yes" />
        <errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="ApplicationServices" applicationName="preview.ucosmic.com" />
        <errorMail subject="Exception Report for preview.ucosmic.com" to="Dan.Ludwig@ucosmic.org" from="cloud@ucosmic.org"
            async="true" smtpPort="0" useSsl="true" noYsod="false" />
    </elmah>
    <location path="elmah.axd" xdt:Transform="Replace" xdt:Locator="Match(path)">
        <system.web>
            <authorization configProtectionProvider="CustomProvider">
                <EncryptedData Type="http://www.w3.org/2001/04/xmlenc#Element" xmlns="http://www.w3.org/2001/04/xmlenc#">
                    <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc" />
                    <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                        <EncryptedKey xmlns="http://www.w3.org/2001/04/xmlenc#">
                            <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" />
                            <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
                                <KeyName>rsaKey</KeyName>
                            </KeyInfo>
                            <CipherData>
                                <CipherValue>QkxSRp431fKkr7dSFwqczgyidKjrZuD3pzUi42p35A7v+ubwwGyBPUTXwHWtQzNQVNLkMaGAgfrXFstfHmVAqUJe7UtTIccHGyGqlnPdThhS5+8snrhxDbjvIwmr8TweKb3T5DfHcmMJixXW4wy/vImXBoGufEA2pNinKzH33jM=</CipherValue>
                            </CipherData>
                        </EncryptedKey>
                    </KeyInfo>
                    <CipherData>
                        <CipherValue>DetY8iJdMwlgNEbiD1Rq1QytopiLuysaqpw5e3KzZrBqVVd14Xd1yCOKpxTqPErxQ1d/DvcWlgXTIWRgH8xYDVtdK2Cj01xC6CBC24CsPgip0pfKzg7IZB3nc2lyRlgrm+18wsQhmF8hf4KKa1/DQrOdLm5CNQsnPrhoSBsf8do=</CipherValue>
                    </CipherData>
                </EncryptedData>
            </authorization>
        </system.web>
    </location>
    <system.webServer>
        <modules runAllManagedModulesForAllRequests="true">
            <!--<add name="ElmahErrorMail" type="Elmah.ErrorMailModule, Elmah" xdt:Transform="Remove" xdt:Locator="Match(name)" />-->
            <add name="ElmahErrorMail" type="Elmah.ErrorMailModule, Elmah" xdt:Transform="Insert" />
        </modules>
        <httpErrors errorMode="Custom" defaultResponseMode="ExecuteURL" xdt:Transform="SetAttributes">
        </httpErrors>
        <security>
            <requestFiltering>
                <!-- unlike httpRuntime maxRequestLength, maxAllowedContentLength is in bytes (25MB) -->
                <requestLimits maxAllowedContentLength="26214400" xdt:Transform="Replace" />
            </requestFiltering>
        </security>
    </system.webServer>
    <system.serviceModel>
        <client>
            <endpoint address="http://ws.geonames.org" binding="webHttpBinding" bindingConfiguration="NGeoBinding" contract="NGeo.GeoNames.IInvokeGeoNamesServices" behaviorConfiguration="NGeoBehavior" xdt:Transform="SetAttributes" xdt:Locator="Match(contract)" />
        </client>
        <behaviors>
            <endpointBehaviors>
                <behavior name="NGeoBehavior">
                    <webHttp />
                </behavior>
            </endpointBehaviors>
        </behaviors>
    </system.serviceModel>
    <system.diagnostics xdt:Transform="Replace">
        <trace>
            <listeners>
                <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics" name="AzureDiagnostics">
                    <!-- Even though filter type causes a warning in VS (and ReSharper), it is required in Azure.
                        Do NOT remove the type="" attribute below unless you are deploying locally. -->
                    <filter type="" />
                </add>
            </listeners>
        </trace>
    </system.diagnostics>
</configuration>
